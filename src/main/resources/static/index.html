<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Anupam - The Incomparable</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-pink: #ffc0cb;
            --light-pink: #ffe4e9;
            --dark-pink: #ff69b4;
            --text-dark: #4a4a4a;
            --white: #ffffff;
        }

        body {
            font-family: 'Georgia', serif;
            color: var(--text-dark);
            background-color: var(--light-pink);
            overflow-x: hidden;
        }

        .navbar {
            background-color: var(--primary-pink);
            border-bottom: 2px solid var(--dark-pink);
            padding: 1rem 0;
        }

        .navbar-brand {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--text-dark) !important;
            letter-spacing: 1px;
        }

        .navbar-nav .nav-link {
            color: var(--text-dark) !important;
            text-transform: uppercase;
            font-size: 0.85rem;
            margin: 0 0.5rem;
            letter-spacing: 1px;
            padding: 0.5rem 0.8rem !important;
        }

        .navbar-nav .nav-link:hover {
            color: var(--dark-pink) !important;
        }

        .cart-icon {
            position: relative;
            font-size: 1.2rem;
            color: var(--text-dark) !important;
        }

        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--dark-pink);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--light-pink) 100%);
            padding: 60px 20px;
            text-align: center;
        }

        .hero-title {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-dark);
            margin-bottom: 1rem;
            letter-spacing: 2px;
            word-wrap: break-word;
        }

        .hero-subtitle {
            font-size: 1rem;
            color: var(--text-dark);
            margin-bottom: 1.5rem;
            font-style: italic;
            padding: 0 15px;
        }

        .hero-tagline {
            color: var(--dark-pink);
            font-size: 1.3rem;
            letter-spacing: 2px;
            margin-bottom: 2rem;
            font-weight: bold;
        }

        .btn-primary-custom {
            background-color: var(--dark-pink);
            color: var(--white);
            border: none;
            padding: 12px 35px;
            font-size: 1rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: all 0.3s;
            border-radius: 5px;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary-custom:hover {
            background-color: #ff1493;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.3);
            color: white;
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--text-dark);
            margin-bottom: 2rem;
            text-align: center;
            letter-spacing: 2px;
            padding: 0 15px;
        }

        .category-card {
            background: var(--white);
            border: 2px solid var(--primary-pink);
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 1.5rem;
            transition: all 0.3s;
            height: 100%;
            border-radius: 10px;
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 192, 203, 0.3);
            border-color: var(--dark-pink);
        }

        .category-title {
            font-size: 1.2rem;
            color: var(--text-dark);
            margin-top: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Product Detail Modal Styles */
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            border-radius: 15px;
            border: 3px solid var(--primary-pink);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary-pink), var(--light-pink));
            border-bottom: 2px solid var(--dark-pink);
            border-radius: 12px 12px 0 0;
        }

        .modal-title {
            color: var(--dark-pink);
            font-weight: bold;
        }

        .modal-body {
            padding: 30px;
        }

        .product-detail-img {
            width: 100%;
            height: 400px;
            background: var(--light-pink);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid var(--primary-pink);
            overflow: hidden;
            margin-bottom: 20px;
        }

        .product-detail-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-detail-img i {
            font-size: 5rem;
            color: var(--dark-pink);
        }

        .product-detail-title {
            font-size: 2rem;
            color: var(--text-dark);
            font-weight: bold;
            margin-bottom: 10px;
        }

        .product-detail-creator {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 15px;
        }

        .product-detail-price {
            font-size: 2.5rem;
            color: var(--dark-pink);
            font-weight: bold;
            margin-bottom: 20px;
        }

        .product-detail-description {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-dark);
            margin-bottom: 20px;
        }

        .product-detail-info {
            background: var(--light-pink);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .product-detail-info-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--primary-pink);
        }

        .product-detail-info-item:last-child {
            border-bottom: none;
        }

        .product-detail-info-label {
            font-weight: 600;
            color: var(--text-dark);
        }

        .product-detail-info-value {
            color: var(--dark-pink);
            font-weight: bold;
        }

        .btn-add-to-cart-modal {
            background: var(--dark-pink);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 10px;
            transition: all 0.3s;
            width: 100%;
        }

        .btn-add-to-cart-modal:hover {
            background: #ff1493;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.4);
        }

        .btn-close {
            background-color: var(--dark-pink);
            opacity: 1;
        }

        .badge-sale {
            background: #ff1493;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            display: inline-block;
            margin-left: 10px;
        }

        .badge-stock {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            display: inline-block;
        }

        .badge-out-of-stock {
            background: #e74c3c;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            display: inline-block;
        }

        @media (max-width: 768px) {
            .product-detail-img {
                height: 300px;
            }

            .product-detail-title {
                font-size: 1.5rem;
            }

            .product-detail-price {
                font-size: 2rem;
            }
        }

        .product-card {
            background: var(--white);
            border: 2px solid var(--primary-pink);
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
            transition: all 0.3s;
            border-radius: 10px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 192, 203, 0.3);
            border-color: var(--dark-pink);
        }

        .product-img {
            width: 100%;
            height: 200px;
            background: var(--light-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            border: 1px solid var(--primary-pink);
            border-radius: 8px;
            overflow: hidden;
        }

        .product-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .product-img i {
            font-size: 2.5rem;
            color: var(--dark-pink);
        }

        .product-title {
            font-size: 1.1rem;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
            flex-grow: 1;
        }

        .product-price {
            font-size: 1.4rem;
            color: var(--dark-pink);
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .btn-cart {
            background-color: var(--dark-pink);
            color: white;
            border: none;
            padding: 10px 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s;
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .btn-cart:hover {
            background-color: #ff1493;
            box-shadow: 0 5px 10px rgba(255, 105, 180, 0.3);
        }

        .about-section {
            background: var(--white);
            padding: 60px 20px;
        }

        .special-offer {
            background: var(--dark-pink);
            color: white;
            padding: 50px 20px;
            text-align: center;
        }

        .special-offer h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .incubation-section {
            background: linear-gradient(135deg, var(--light-pink) 0%, var(--primary-pink) 100%);
            padding: 60px 20px;
        }

        .footer {
            background: var(--dark-pink);
            color: white;
            padding: 40px 20px 20px;
        }

        .footer h5 {
            color: var(--white);
            margin-bottom: 1rem;
            letter-spacing: 1px;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .footer p,
        .footer li {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .footer a {
            color: var(--light-pink);
            text-decoration: none;
            transition: color 0.3s;
        }

        .footer a:hover {
            color: var(--white);
        }

        .footer ul {
            list-style: none;
            padding-left: 0;
        }

        .social-icons a {
            color: white;
            font-size: 1.5rem;
            margin-right: 1rem;
            transition: color 0.3s;
        }

        .social-icons a:hover {
            color: var(--light-pink);
        }

        .badge-special {
            background-color: #ff1493;
            color: white;
            padding: 8px 20px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 5px;
            display: inline-block;
        }

        .badge-coming {
            background-color: var(--primary-pink);
            color: var(--text-dark);
            padding: 8px 20px;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-radius: 5px;
            display: inline-block;
        }

        .login-link {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--dark-pink);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(255, 105, 180, 0.4);
            transition: all 0.3s;
            z-index: 1000;
            text-decoration: none;
        }

        .login-link:hover {
            background: #ff1493;
            transform: scale(1.1);
            color: white;
        }

        .slider-container {
            position: relative;
            width: 100%;
            padding: 0 70px;
        }

        .slider-viewport {
            overflow: hidden;
            width: 100%;
            position: relative;
            padding: 20px 0;
        }

        .slider-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }

        .product-card-wrapper {
            flex: 0 0 25%;
            padding: 0 10px;
            box-sizing: border-box;
        }

        .slider-track.few-products {
            justify-content: center;
        }

        .slider-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: var(--dark-pink);
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 22px;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 100;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(255, 105, 180, 0.3);
        }

        .left-arrow {
            left: 0;
        }

        .right-arrow {
            right: 0;
        }

        .slider-arrow:hover {
            background: #ff1493;
            transform: translateY(-50%) scale(1.15);
            box-shadow: 0 6px 20px rgba(255, 105, 180, 0.5);
        }

        .slider-arrow:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .slider-arrow:disabled:hover {
            background: var(--dark-pink);
            transform: translateY(-50%) scale(1);
            box-shadow: 0 4px 12px rgba(255, 105, 180, 0.3);
        }

        @media (max-width: 992px) {
            .product-card-wrapper {
                flex: 0 0 33.333%;
            }

            .slider-container {
                padding: 0 60px;
            }

            .slider-arrow {
                width: 45px;
                height: 45px;
                font-size: 20px;
            }
        }

        @media (max-width: 768px) {
            .product-card-wrapper {
                flex: 0 0 50%;
            }

            .slider-container {
                padding: 0 55px;
            }

            .slider-arrow {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
        }

        @media (max-width: 576px) {
            .product-card-wrapper {
                flex: 0 0 100%;
            }

            .slider-container {
                padding: 0 50px;
            }

            .slider-arrow {
                width: 35px;
                height: 35px;
                font-size: 16px;
                background: rgba(255, 105, 180, 0.95);
            }
        }
    </style>
</head>

<body>
    <!-- Admin Link -->
    <a href="login.html" class="login-link" title="Login">
        <i class="fas fa-user-shield"></i>
    </a>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="#">PROJECT ANUPAM</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="#shop">Shop</a></li>
                    <li class="nav-item"><a class="nav-link" href="#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
                    <li class="nav-item ms-2">
                        <a href="cart.html" class="nav-link cart-icon">
                            <i class="fas fa-shopping-cart"></i>
                            <span id="cartBadge" class="cart-badge" style="display: none;">0</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero-section">
        <div class="container">
            <h1 class="hero-title">DISCOVER OUR COLLECTION</h1>
            <p class="hero-subtitle">Unique products designed to elevate your everyday life</p>
            <p class="hero-tagline">THE INCOMPARABLE</p>
            <a href="#shop" class="btn btn-primary-custom">Shop Now</a>
        </div>
    </section>

    <!-- Categories -->
    <section class="py-4">
        <div class="container">
            <div class="row" style="justify-content: center;">
                <div class="col-lg-2 col-md-4 col-sm-6 col-6">
                    <div class="category-card" onclick="loadProducts()">
                        <i class="fas fa-th fa-3x" style="color: var(--dark-pink);"></i>
                        <h3 class="category-title">All Products</h3>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 col-sm-6 col-6">
                    <div class="category-card" onclick="filterProducts('new')">
                        <i class="fas fa-star fa-3x" style="color: var(--dark-pink);"></i>
                        <h3 class="category-title">New</h3>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 col-sm-6 col-6">
                    <div class="category-card" onclick="filterProducts('sale')">
                        <i class="fas fa-tag fa-3x" style="color: #ff1493;"></i>
                        <h3 class="category-title">On Sale</h3>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 col-sm-6 col-6">
                    <div class="category-card" onclick="filterProducts('gift')">
                        <i class="fas fa-gift fa-3x" style="color: var(--dark-pink);"></i>
                        <h3 class="category-title">Gift Ideas</h3>
                    </div>
                </div>
                <div class="col-lg-2 col-md-4 col-sm-6 col-6">
                    <div class="category-card" onclick="filterProducts('bestseller')">
                        <i class="fas fa-fire fa-3x" style="color: #ff1493;"></i>
                        <h3 class="category-title">Best Sellers</h3>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about-section">
        <div class="container">
            <h2 class="section-title">Welcome to Project Anupam</h2>
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <p class="lead text-center">
                        Project Anupam is a platform for students to showcase their handmade ventures,
                        helping them establish their own entrepreneurial identity. We aim to build a space
                        where they can transform their passion into revenue-generating ventures by creating
                        a bridge between student creators and customers, encouraging innovation without
                        compromising talent or time.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="shop" class="py-4" style="background: var(--light-pink);">
        <div class="container">
            <h2 class="section-title">SHOP NOW!</h2>

            <div class="position-relative">
                <button id="leftArrow" class="slider-arrow left-arrow">&lt;</button>

                <div id="sliderViewport" class="slider-viewport">
                    <div id="productsSlider" class="slider-track"></div>
                </div>

                <button id="rightArrow" class="slider-arrow right-arrow">&gt;</button>
            </div>
        </div>
    </section>

    <!-- Special Offer Section -->
    <section class="special-offer">
        <div class="container">
            <span class="badge badge-special mb-3">SPECIAL OFFER</span>
            <h2>Stylish Home Decor</h2>

            <!-- Home Decor Products Slider -->
            <div class="position-relative mt-4">
                <button id="homeDecorLeftArrow" class="slider-arrow left-arrow">&lt;</button>

                <div id="homeDecorSliderViewport" class="slider-viewport">
                    <div id="homeDecorSlider" class="slider-track"></div>
                </div>

                <button id="homeDecorRightArrow" class="slider-arrow right-arrow">&gt;</button>
            </div>
        </div>
    </section>

    <!-- Incubation Program -->
    <section class="incubation-section">
        <div class="container">
            <h2 class="section-title">Incubation Program</h2>
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <p class="lead text-center">
                        The incubation program fosters innovation and entrepreneurship by creating a
                        supportive ecosystem for the students. Our mission is to provide resources,
                        mentorship and guidance to help young minds convert ideas into reality. We aim
                        to equip students with practical business experience and the confidence to make
                        a lasting impact on society.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contact" class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>Contact Us</h5>
                    <p><i class="fas fa-envelope me-2"></i> projectanupamjdmc@gmail.com</p>
                    <p><i class="fas fa-envelope me-2"></i> incubation@jdm.du.ac.in</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Find Us Elsewhere</h5>
                    <div class="social-icons mb-3">
                        <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="#" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    </div>
                    <p>@incubationprogram_jdmc</p>
                    <p>@projectanupam</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h5>Quick Links</h5>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#shop">Shop</a></li>
                        <li><a href="#about">About</a></li>
                        <li><a href="#contact">Contact</a></li>
                    </ul>
                </div>
            </div>
            <hr style="border-color: var(--light-pink); margin: 20px 0;">
            <div class="text-center">
                <p style="margin-bottom: 0;">&copy; 2024 Project Anupam - The Incomparable. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Product Detail Modal -->
    <div class="modal fade" id="productDetailModal" tabindex="-1" aria-labelledby="productDetailModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productDetailModalLabel">Product Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="productDetailContent">
                    <div class="text-center py-5">
                        <div class="spinner-border text-pink" role="status" style="color: var(--dark-pink);">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/global.js"></script>
    <script>
        let allProducts = [];
        let currentSlide = 0;

        function getItemsPerSlide() {
            if (window.innerWidth <= 576) return 1;
            if (window.innerWidth <= 768) return 2;
            if (window.innerWidth <= 992) return 3;
            return 4;
        }

        function resolveImageUrl(imagePath) {
            if (!imagePath) return '';
            if (imagePath.startsWith("http")) return imagePath;
            return `https://projectanupam.onrender.com${imagePath.startsWith("/") ? imagePath : "/" + imagePath}`;
        }

        function renderProducts(products) {
            console.log('Rendering products:', products);
            const slider = document.getElementById("productsSlider");
            const leftArrow = document.getElementById("leftArrow");
            const rightArrow = document.getElementById("rightArrow");

            slider.innerHTML = "";

            const itemsPerSlide = getItemsPerSlide();

            if (products.length === 0) {
                slider.innerHTML = '<div style="text-align: center; padding: 50px; width: 100%;"><p style="color: var(--dark-pink); font-size: 1.2rem;">No products available</p></div>';
                leftArrow.style.display = "none";
                rightArrow.style.display = "none";
                return;
            }

            if (products.length <= itemsPerSlide) {
                slider.classList.add("few-products");
                leftArrow.style.display = "none";
                rightArrow.style.display = "none";
            } else {
                slider.classList.remove("few-products");
                leftArrow.style.display = "flex";
                rightArrow.style.display = "flex";
            }

            products.forEach(p => {
                const wrapper = document.createElement('div');
                wrapper.className = 'product-card-wrapper';

                const imageUrl = p.image ? resolveImageUrl(p.image) : '';
                const displayPrice = p.effectivePrice || p.price;

                wrapper.innerHTML = `
                <div class="product-card" onclick="showProductDetail(${p.id})">
                    <div class="product-img">
                        ${imageUrl ? `<img src="${imageUrl}" alt="${p.name}" onerror="this.parentElement.innerHTML='<i class=\\'fas fa-image\\'></i>'">` : `<i class="fas fa-image"></i>`}
                    </div>
                    <h3 class="product-title">${p.name}</h3>
                    <p style="color: #7f8c8d; font-size: 0.9rem; margin-bottom: 0.5rem;">by ${p.studentName || 'Anonymous'}</p>
                    <p class="product-price">₹${displayPrice}</p>
                    <button class="btn btn-cart" onclick="event.stopPropagation(); handleAddToCart(${p.id}, ${p.quantity})">
                        <i class="fas fa-shopping-cart me-2"></i>ADD TO CART
                    </button>
                </div>
            `;
                slider.appendChild(wrapper);
            });

            currentSlide = 0;
            updateSlider();
        }

        function updateSlider() {
            const slider = document.getElementById("productsSlider");
            const leftArrow = document.getElementById("leftArrow");
            const rightArrow = document.getElementById("rightArrow");
            const total = allProducts.length;
            const itemsPerSlide = getItemsPerSlide();

            if (total === 0) return;

            const totalSlides = Math.ceil(total / itemsPerSlide);
            const maxSlide = totalSlides - 1;

            if (currentSlide < 0) currentSlide = 0;
            if (currentSlide > maxSlide) currentSlide = maxSlide;

            const cardWidth = 100 / itemsPerSlide;
            const offset = currentSlide * itemsPerSlide * cardWidth;
            slider.style.transform = `translateX(-${offset}%)`;

            leftArrow.disabled = currentSlide === 0;
            rightArrow.disabled = currentSlide >= maxSlide;
        }

        function initializeArrows() {
            document.getElementById("leftArrow").onclick = () => {
                if (currentSlide > 0) {
                    currentSlide--;
                    updateSlider();
                }
            };

            document.getElementById("rightArrow").onclick = () => {
                const itemsPerSlide = getItemsPerSlide();
                const totalSlides = Math.ceil(allProducts.length / itemsPerSlide);
                if (currentSlide < totalSlides - 1) {
                    currentSlide++;
                    updateSlider();
                }
            };
        }

        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                currentSlide = 0;
                renderProducts(allProducts);
            }, 250);
        });

        async function loadProducts() {
            console.log('Loading products...');
            try {
                const result = await apiCall('/public/products');
                console.log('API Result:', result);

                if (result && result.success) {
                    allProducts = result.data || [];
                    console.log('Products loaded:', allProducts.length);
                    renderProducts(allProducts);
                } else {
                    throw new Error(result?.message || 'Failed to load products');
                }
            } catch (err) {
                console.error('Error loading products:', err);
                const slider = document.getElementById("productsSlider");
                slider.innerHTML = '<div style="text-align: center; padding: 50px; width: 100%;"><p style="color: var(--dark-pink); font-size: 1.2rem;">Failed to load products. Please check your connection.</p></div>';
            }
        }

        async function filterProducts(filterType) {
            console.log('Filtering by:', filterType);
            try {
                let endpoint = '/public/products';

                // Handle different filter types
                switch (filterType) {
                    case 'sale':
                        endpoint += '?onSale=true';
                        break;
                    case 'new':
                        endpoint += '?newProducts=true';
                        break;
                    case 'bestseller':
                        endpoint += '?bestSeller=true';
                        break;
                    case 'gift':
                        endpoint += `?category=${encodeURIComponent(filterType)}`;
                        break;
                    default:
                        endpoint += `?category=${encodeURIComponent(filterType)}`;
                }

                const result = await apiCall(endpoint);

                if (result && result.success) {
                    allProducts = result.data || [];
                    currentSlide = 0;
                    renderProducts(allProducts);
                    document.getElementById('shop').scrollIntoView({ behavior: 'smooth' });
                } else {
                    throw new Error('Failed to filter products');
                }
            } catch (err) {
                console.error('Error filtering products:', err);
                showNotification("Failed to filter products.", 'error');
            }
        }

        async function loadHomeDecorProducts() {
            try {
                const result = await apiCall('/public/products?category=Home%20Decor');

                if (result && result.success) {
                    const products = result.data || [];
                    renderHomeDecorSlider(products);
                } else {
                    console.error('Failed to load home decor products');
                }
            } catch (err) {
                console.error('Error loading home decor products:', err);
            }
        }

        async function loadHomeDecorProducts() {
            try {
                const result = await apiCall('/public/products?category=Home%20Decor');

                if (result && result.success) {
                    const products = result.data || [];
                    renderHomeDecorSlider(products);
                } else {
                    console.error('Failed to load home decor products');
                }
            } catch (err) {
                console.error('Error loading home decor products:', err);
            }
        }

        let homeDecorCurrentSlide = 0;

        function renderHomeDecorSlider(products) {
            const slider = document.getElementById('homeDecorSlider');
            const leftArrow = document.getElementById('homeDecorLeftArrow');
            const rightArrow = document.getElementById('homeDecorRightArrow');

            slider.innerHTML = "";

            if (!products.length) {
                slider.innerHTML = '<div style="text-align:center; padding:50px;">No products available</div>';
                leftArrow.style.display = "none";
                rightArrow.style.display = "none";
                return;
            }

            if (products.length <= getItemsPerSlide()) {
                slider.classList.add("few-products");
                leftArrow.style.display = "none";
                rightArrow.style.display = "none";
            } else {
                slider.classList.remove("few-products");
                leftArrow.style.display = "flex";
                rightArrow.style.display = "flex";
            }

            products.forEach(p => {
                const wrapper = document.createElement('div');
                wrapper.className = 'product-card-wrapper';

                const imageUrl = p.image ? resolveImageUrl(p.image) : '';
                const displayPrice = p.effectivePrice || p.price;

                wrapper.innerHTML = `
            <div class="product-card" onclick="showProductDetail(${p.id})">
                <div class="product-img">
                    ${imageUrl ? `<img src="${imageUrl}" alt="${p.name}" onerror="this.parentElement.innerHTML='<i class=\\'fas fa-image\\'></i>'">` : `<i class="fas fa-image"></i>`}
                </div>
                <h3 class="product-title">${p.name}</h3>
                <p style="color: #7f8c8d; font-size: 0.9rem; margin-bottom:0.5rem;">by ${p.studentName || 'Anonymous'}</p>
                <p class="product-price">₹${displayPrice}</p>
                <button class="btn btn-cart" onclick="event.stopPropagation(); handleAddToCart(${p.id}, ${p.quantity})">
                    <i class="fas fa-shopping-cart me-2"></i>ADD TO CART
                </button>
            </div>
        `;
                slider.appendChild(wrapper);
            });

            homeDecorCurrentSlide = 0;
            updateHomeDecorSlider();

            // Initialize arrows
            leftArrow.onclick = () => {
                if (homeDecorCurrentSlide > 0) {
                    homeDecorCurrentSlide--;
                    updateHomeDecorSlider();
                }
            };
            rightArrow.onclick = () => {
                const itemsPerSlide = getItemsPerSlide();
                const totalSlides = Math.ceil(products.length / itemsPerSlide);
                if (homeDecorCurrentSlide < totalSlides - 1) {
                    homeDecorCurrentSlide++;
                    updateHomeDecorSlider();
                }
            };
        }

        function updateHomeDecorSlider() {
            const slider = document.getElementById('homeDecorSlider');
            const leftArrow = document.getElementById('homeDecorLeftArrow');
            const rightArrow = document.getElementById('homeDecorRightArrow');

            const itemsPerSlide = getItemsPerSlide();
            const totalSlides = Math.ceil(slider.children.length / itemsPerSlide);
            const maxSlide = totalSlides - 1;

            if (homeDecorCurrentSlide < 0) homeDecorCurrentSlide = 0;
            if (homeDecorCurrentSlide > maxSlide) homeDecorCurrentSlide = maxSlide;

            const cardWidth = 100 / itemsPerSlide;
            const offset = homeDecorCurrentSlide * itemsPerSlide * cardWidth;
            slider.style.transform = `translateX(-${offset}%)`;

            leftArrow.disabled = homeDecorCurrentSlide === 0;
            rightArrow.disabled = homeDecorCurrentSlide >= maxSlide;
        }

        function handleAddToCart(productId, stockQuantity) {
            // Check stock availability
            if (stockQuantity <= 0) {
                showNotification('Product is out of stock!', 'error');
                return;
            }

            // Check if already in cart
            const cart = getCart();
            const existingItem = cart.find(item => item.productId === productId);

            if (existingItem && existingItem.quantity >= stockQuantity) {
                showNotification('Cannot add more items. Stock limit reached!', 'error');
                return;
            }

            addToCart(productId, 1);
        }

        function showProductDetail(productId) {
            const product = allProducts.find(p => p.id === productId);
            if (!product) return;

            const modal = new bootstrap.Modal(document.getElementById('productDetailModal'));
            const imageUrl = product.image ? resolveImageUrl(product.image) : '';
            const displayPrice = product.effectivePrice || product.price;
            const hasDiscount = product.onSale && product.effectivePrice && product.effectivePrice < product.price;
            const inStock = product.quantity > 0;

            const modalContent = `
            <div class="row">
                <div class="col-md-6">
                    <div class="product-detail-img">
                        ${imageUrl ? `<img src="${imageUrl}" alt="${product.name}" onerror="this.parentElement.innerHTML='<i class=\\'fas fa-image\\'></i>'">` : `<i class="fas fa-image"></i>`}
                    </div>
                </div>
                <div class="col-md-6">
                    <h2 class="product-detail-title">
                        ${product.name}
                        ${hasDiscount ? '<span class="badge-sale">ON SALE</span>' : ''}
                    </h2>
                    <p class="product-detail-creator">
                        <i class="fas fa-user me-2"></i>by ${product.studentName || 'Anonymous'}
                    </p>
                    <div class="product-detail-price">
                        ${hasDiscount ? `<del style="font-size: 1.5rem; color: #95a5a6;">₹${product.price}</del> ` : ''}
                        ₹${displayPrice}
                    </div>
                    
                    <div class="product-detail-info">
                        <div class="product-detail-info-item">
                            <span class="product-detail-info-label">Category:</span>
                            <span class="product-detail-info-value">${product.category || 'N/A'}</span>
                        </div>
                        <div class="product-detail-info-item">
                            <span class="product-detail-info-label">Availability:</span>
                            <span class="product-detail-info-value">
                                ${inStock ? `<span class="badge-stock">${product.quantity} in stock</span>` : '<span class="badge-out-of-stock">Out of Stock</span>'}
                            </span>
                        </div>
                        ${product.description ? `
                        <div class="product-detail-info-item">
                            <span class="product-detail-info-label">Description:</span>
                        </div>
                        ` : ''}
                    </div>
                    
                    ${product.description ? `
                    <div class="product-detail-description">
                        ${product.description}
                    </div>
                    ` : ''}
                    
                    <button class="btn-add-to-cart-modal" 
                            onclick="handleAddToCartFromModal(${product.id}, ${product.quantity})" 
                            ${!inStock ? 'disabled' : ''}>
                        <i class="fas fa-shopping-cart me-2"></i>
                        ${inStock ? 'ADD TO CART' : 'OUT OF STOCK'}
                    </button>
                </div>
            </div>
        `;

            document.getElementById('productDetailContent').innerHTML = modalContent;
            modal.show();
        }

        function handleAddToCartFromModal(productId, stockQuantity) {
            handleAddToCart(productId, stockQuantity);

            // Close modal after adding to cart
            const modalElement = document.getElementById('productDetailModal');
            const modal = bootstrap.Modal.getInstance(modalElement);
            if (modal) {
                modal.hide();
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            console.log('Page loaded, initializing...');
            initializeArrows();
            loadProducts();
            loadHomeDecorProducts();
            updateCartBadge();
        });
    </script>

</body>

</html>